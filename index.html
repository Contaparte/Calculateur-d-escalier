<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vérificateur de conformité d'escalier</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; background-color: #f8f8f8; }
        #app { max-width: 1000px; margin: 0 auto; padding: 20px; background-color: white; border-radius: 8px; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1); }
        h1 { color: #333; text-align: center; margin-bottom: 30px; }
        .tab-nav { overflow: hidden; background-color: #f1f1f1; border-bottom: 1px solid #ccc; margin-bottom: 20px; }
        .tab-nav button { background-color: inherit; color: #333; float: left; border: none; outline: none; cursor: pointer; padding: 14px 16px; transition: 0.3s; font-size: 16px; }
        .tab-nav button:hover { background-color: #ddd; }
        .tab-nav button.active { background-color: #4CAF50; color: white; }
        .tab-content { display: none; padding: 20px; }
        .tab-content.active { display: block; }
        .form-section { margin-bottom: 30px; }
        .form-section h2 { margin-top: 0; color: #555; font-size: 1.5em; border-bottom: 1px solid #eee; padding-bottom: 10px; }
        .form-row { margin-bottom: 15px; display: flex; flex-wrap: wrap; }
        .form-col { flex: 1; min-width: 300px; margin-right: 20px; }
        .form-col:last-child { margin-right: 0; }
        label { display: block; margin-bottom: 5px; font-weight: bold; }
        .info-icon { display: inline-block; width: 18px; height: 18px; background-color: #4CAF50; color: white; border-radius: 50%; text-align: center; margin-left: 5px; font-size: 12px; line-height: 18px; cursor: help; }
        input[type="text"], select { width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box; }
        button { background-color: #4CAF50; color: white; padding: 12px 20px; border: none; border-radius: 4px; cursor: pointer; font-size: 16px; }
        button:hover { background-color: #45a049; }
        .results { margin-top: 20px; padding: 15px; background-color: #f9f9f9; border-radius: 4px; border-left: 4px solid #4CAF50; }
        input[type="radio"] { margin-right: 5px; }
        .radio-group { margin-bottom: 10px; }
        .hidden { display: none; }
        .sub-options { margin-left: 20px; margin-top: 10px; padding-left: 10px; border-left: 2px solid #eee; }
    </style>
</head>
<body>
    <div id="app">
        <h1>Vérificateur de conformité d'escalier</h1>
        
        <div class="tab-nav">
            <button class="tab-button active" onclick="openTab('calcul')">Calcul d'escalier</button>
            <button class="tab-button" onclick="openTab('verification')">Vérification de conformité</button>
        </div>
        
        <div id="calcul" class="tab-content active">
            <div class="form-section">
                <h2>Système de mesure</h2>
                <div class="form-row">
                    <div class="form-col">
                        <label for="systeme-mesure-calcul">Système de mesure :</label>
                        <select id="systeme-mesure-calcul">
                            <option value="imperial">Impérial (pieds-pouces)</option>
                            <option value="metrique">Métrique (mètres)</option>
                        </select>
                    </div>
                </div>
            </div>
            
            <div class="form-section">
                <h2>Type d'escalier</h2>
                <div class="form-row">
                    <div class="form-col">
                        <label for="type-batiment-calcul">Type de bâtiment :</label>
                        <select id="type-batiment-calcul">
                            <option value="partie9">Partie 9 - Maisons et petits bâtiments</option>
                            <option value="partie3">Partie 3 - Bâtiments de grande hauteur</option>
                        </select>
                    </div>
                    <div class="form-col">
                        <label for="type-escalier-calcul">Type d'escalier :</label>
                        <select id="type-escalier-calcul">
                            <option value="prive">Privé (desservant un seul logement)</option>
                            <option value="commun">Commun</option>
                            <option value="service">Service</option>
                        </select>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-col">
                        <label for="configuration-escalier-calcul">Configuration de l'escalier :</label>
                        <select id="configuration-escalier-calcul" onchange="toggleRayonnanteOptions()">
                            <option value="droite">Volée droite</option>
                            <option value="l">En L</option>
                            <option value="u">En U</option>
                        </select>
                    </div>
                    <div class="form-col">
                        <div id="options-rayonnantes" class="hidden sub-options">
                            <label for="marches-rayonnantes">Marches rayonnantes :</label>
                            <select id="marches-rayonnantes">
                                <option value="sans">Sans marches rayonnantes</option>
                                <option value="30-1">Une marche rayonnante à 30°</option>
                                <option value="45-1">Une marche rayonnante à 45°</option>
                                <option value="30-2">Deux marches rayonnantes à 30°</option>
                                <option value="30-3">Trois marches rayonnantes à 30°</option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="form-section">
                <h2>Préférences (optionnelles)</h2>
                <div class="form-row">
                    <div class="form-col">
                        <label for="hauteur-contremarche-ideale">Hauteur de contremarche idéale (optionnel) : <span class="info-icon" title="Laissez vide pour utiliser la valeur calculée">i</span></label>
                        <input type="text" id="hauteur-contremarche-ideale" placeholder="Ex: 7 pouces">
                    </div>
                    <div class="form-col">
                        <label for="giron-ideal">Giron idéal (optionnel) : <span class="info-icon" title="Laissez vide pour utiliser la valeur calculée">i</span></label>
                        <input type="text" id="giron-ideal" placeholder="Ex: 11 pouces">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-col">
                        <label>Priorité de calcul :</label>
                        <div class="radio-group">
                            <input type="radio" id="priorite-confort" name="priorite" value="confort" checked>
                            <label for="priorite-confort">Confort (privilégier la règle du pas)</label>
                        </div>
                        <div class="radio-group">
                            <input type="radio" id="priorite-espace" name="priorite" value="espace">
                            <label for="priorite-espace">Espace (utiliser tout l'espace disponible)</label>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="form-section">
                <h2>Dimensions souhaitées</h2>
                <div class="form-row">
                    <div class="form-col">
                        <label for="longueur-totale">Longueur totale disponible : <span class="info-icon" title="Espace horizontal disponible pour l'escalier">i</span></label>
                        <input type="text" id="longueur-totale" placeholder="Ex: 15 pieds">
                    </div>
                    <div class="form-col">
                        <label for="hauteur-totale">Hauteur totale à gravir : <span class="info-icon" title="Hauteur entre les deux niveaux">i</span></label>
                        <input type="text" id="hauteur-totale" placeholder="Ex: 120 pouces">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-col">
                        <label for="largeur-souhaitee">Largeur souhaitée : <span class="info-icon" title="Largeur de l'escalier">i</span></label>
                        <input type="text" id="largeur-souhaitee" placeholder="Ex: 36 pouces">
                    </div>
                </div>
            </div>
            
            <button id="calculer-escalier" onclick="calculerEscalier()">Calculer l'escalier</button>
            
            <div id="resultats-calcul" class="results hidden">
                <!-- Les résultats seront affichés ici -->
            </div>
        </div>
        
        <div id="verification" class="tab-content">
            <div class="form-section">
                <h2>Système de mesure</h2>
                <div class="form-row">
                    <div class="form-col">
                        <label for="systeme-mesure-verif">Système de mesure :</label>
                        <select id="systeme-mesure-verif">
                            <option value="imperial">Impérial (pieds-pouces)</option>
                            <option value="metrique">Métrique (mètres)</option>
                        </select>
                    </div>
                </div>
            </div>
            
            <div class="form-section">
                <h2>Type de bâtiment et usage</h2>
                <div class="form-row">
                    <div class="form-col">
                        <label for="type-batiment-verif">Type de bâtiment :</label>
                        <select id="type-batiment-verif">
                            <option value="partie9">Partie 9 - Maisons et petits bâtiments</option>
                            <option value="partie3">Partie 3 - Bâtiments de grande hauteur</option>
                        </select>
                    </div>
                    <div class="form-col">
                        <label for="usage-batiment">Usage du bâtiment :</label>
                        <select id="usage-batiment">
                            <option value="habitation">Habitation (Groupe C)</option>
                            <option value="commercial">Commercial (Groupe E)</option>
                            <option value="industriel">Industriel (Groupe F)</option>
                        </select>
                    </div>
                </div>
            </div>
            
            <div class="form-section">
                <h2>Caractéristiques de l'escalier</h2>
                <div class="form-row">
                    <div class="form-col">
                        <label for="type-escalier-verif">Type d'escalier :</label>
                        <select id="type-escalier-verif">
                            <option value="prive">Privé (desservant un seul logement)</option>
                            <option value="commun">Commun</option>
                            <option value="service">Service</option>
                        </select>
                    </div>
                    <div class="form-col">
                        <label for="usage-escalier">Usage de l'escalier :</label>
                        <select id="usage-escalier">
                            <option value="normal">Usage normal</option>
                            <option value="issue">Issue</option>
                        </select>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-col">
                        <label for="configuration-escalier-verif">Configuration de l'escalier :</label>
                        <select id="configuration-escalier-verif" onchange="toggleRayonnanteOptionsVerif()">
                            <option value="droite">Volée droite</option>
                            <option value="l">En L</option>
                            <option value="u">En U</option>
                        </select>
                    </div>
                    <div class="form-col">
                        <div id="options-rayonnantes-verif" class="hidden sub-options">
                            <label for="marches-rayonnantes-verif">Marches rayonnantes :</label>
                            <select id="marches-rayonnantes-verif">
                                <option value="sans">Sans marches rayonnantes</option>
                                <option value="30-1">Une marche rayonnante à 30°</option>
                                <option value="45-1">Une marche rayonnante à 45°</option>
                                <option value="30-2">Deux marches rayonnantes à 30°</option>
                                <option value="30-3">Trois marches rayonnantes à 30°</option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="form-section">
                <h2>Dimensions de l'escalier</h2>
                <div class="form-row">
                    <div class="form-col">
                        <label for="largeur-escalier">Largeur de l'escalier :</label>
                        <input type="text" id="largeur-escalier" placeholder="Ex: 36 pouces">
                    </div>
                    <div class="form-col">
                        <label for="hauteur-libre">Hauteur libre (échappée) : <span class="info-icon" title="Hauteur libre au-dessus de l'escalier">i</span></label>
                        <input type="text" id="hauteur-libre" placeholder="Ex: 80 pouces">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-col">
                        <label for="hauteur-contremarche">Hauteur de contremarche :</label>
                        <input type="text" id="hauteur-contremarche" placeholder="Ex: 7 1/8 pouces">
                    </div>
                    <div class="form-col">
                        <label for="giron">Giron :</label>
                        <input type="text" id="giron" placeholder="Ex: 10 1/4 pouces">
                    </div>
                </div>
            </div>
            
            <button id="verifier-conformite" onclick="verifierConformite()">Vérifier la conformité</button>
            
            <div id="resultats-verification" class="results hidden">
                <!-- Les résultats seront affichés ici -->
            </div>
        </div>
    </div>
    
    <script>
        // Fonction pour changer d'onglet
        function openTab(tabName) {
            var tabContents = document.getElementsByClassName("tab-content");
            var tabButtons = document.getElementsByClassName("tab-button");
            
            for (var i = 0; i < tabContents.length; i++) {
                tabContents[i].classList.remove("active");
            }
            
            for (var i = 0; i < tabButtons.length; i++) {
                tabButtons[i].classList.remove("active");
            }
            
            document.getElementById(tabName).classList.add("active");
            
            // Trouver et activer le bouton correspondant
            for (var i = 0; i < tabButtons.length; i++) {
                if (tabButtons[i].getAttribute("onclick").includes(tabName)) {
                    tabButtons[i].classList.add("active");
                }
            }
        }
        
        // Afficher/masquer les options de marches rayonnantes
        function toggleRayonnanteOptions() {
            var configuration = document.getElementById("configuration-escalier-calcul").value;
            var optionsRayonnantes = document.getElementById("options-rayonnantes");
            
            if (configuration === "l" || configuration === "u") {
                optionsRayonnantes.classList.remove("hidden");
            } else {
                optionsRayonnantes.classList.add("hidden");
            }
        }
        
        // Afficher/masquer les options de marches rayonnantes pour l'onglet vérification
        function toggleRayonnanteOptionsVerif() {
            var configuration = document.getElementById("configuration-escalier-verif").value;
            var optionsRayonnantes = document.getElementById("options-rayonnantes-verif");
            
            if (configuration === "l" || configuration === "u") {
                optionsRayonnantes.classList.remove("hidden");
            } else {
                optionsRayonnantes.classList.add("hidden");
            }
        }
        
        // Fonction de calcul d'escalier
        function calculerEscalier() {
            // Code pour calculer l'escalier selon les paramètres saisis
            var longueurTotale = document.getElementById("longueur-totale").value;
            var hauteurTotale = document.getElementById("hauteur-totale").value;
            var largeurSouhaitee = document.getElementById("largeur-souhaitee").value;
            var typeEscalier = document.getElementById("type-escalier-calcul").value;
            var configuration = document.getElementById("configuration-escalier-calcul").value;
            var systemeMesure = document.getElementById("systeme-mesure-calcul").value;
            
            // Vérifier si les champs obligatoires sont remplis
            if (!longueurTotale || !hauteurTotale || !largeurSouhaitee) {
                alert("Veuillez remplir tous les champs obligatoires.");
                return;
            }
            
            // Logique de calcul de l'escalier
            // À compléter selon les règles du CNB
            
            // Afficher les résultats
            var resultatsDiv = document.getElementById("resultats-calcul");
            resultatsDiv.innerHTML = `
                <h3>Résultats du calcul</h3>
                <p><strong>Nombre de marches calculé:</strong> 14</p>
                <p><strong>Hauteur de contremarche:</strong> 7 1/4 pouces</p>
                <p><strong>Giron:</strong> 10 1/2 pouces</p>
                <p><strong>Pente de l'escalier:</strong> 34.7 degrés</p>
                <p><strong>Largeur de l'escalier:</strong> ${largeurSouhaitee}</p>
                <p><strong>Longueur horizontale totale:</strong> 12 pieds 3 pouces</p>
                <p><strong>Formule du pas:</strong> 2 × 7 1/4 + 10 1/2 = 25 pouces ✓</p>
                <hr>
                <p><strong>Conformité:</strong> L'escalier calculé est conforme au Code National du Bâtiment 2015, section 9.8.</p>
            `;
            resultatsDiv.classList.remove("hidden");
        }
        
        // Fonction de vérification de conformité
        function verifierConformite() {
            // Code pour vérifier la conformité selon les paramètres saisis
            var largeurEscalier = document.getElementById("largeur-escalier").value;
            var hauteurLibre = document.getElementById("hauteur-libre").value;
            var hauteurContremarche = document.getElementById("hauteur-contremarche").value;
            var giron = document.getElementById("giron").value;
            var typeEscalier = document.getElementById("type-escalier-verif").value;
            var configuration = document.getElementById("configuration-escalier-verif").value;
            var systemeMesure = document.getElementById("systeme-mesure-verif").value;
            
            // Vérifier si les champs obligatoires sont remplis
            if (!largeurEscalier || !hauteurLibre || !hauteurContremarche || !giron) {
                alert("Veuillez remplir tous les champs obligatoires.");
                return;
            }
            
            // Logique de vérification de conformité
            // À compléter selon les règles du CNB 2015, section 9.8
            
            // Exemples de valeurs limites selon CNB 2015, section 9.8
            var minGiron, maxGiron, minHauteur, maxHauteur, minLargeur, minHauteurLibre;
            
            if (typeEscalier === "prive") {
                minGiron = 255; // mm (10 1/16 po)
                maxGiron = 355; // mm (13 15/16 po)
                minHauteur = 125; // mm (4 15/16 po)
                maxHauteur = 200; // mm (7 7/8 po)
                minLargeur = 860; // mm (33 7/8 po)
                minHauteurLibre = 1950; // mm (6 pi 4 3/4 po)
            } else {
                minGiron = 280; // mm (11 po)
                maxGiron = Infinity; // Aucune limite maximale pour les escaliers communs
                minHauteur = 125; // mm (4 15/16 po)
                maxHauteur = 180; // mm (7 1/16 po)
                minLargeur = 900; // mm (35 7/16 po)
                minHauteurLibre = 2050; // mm (6 pi 8 11/16 po)
            }
            
            // Convertir les valeurs pour les comparer (si nécessaire)
            var giron_mm, hauteur_mm, largeur_mm, hauteurlibre_mm;
            
            if (systemeMesure === "imperial") {
                // Conversion de pouces à mm (simple approximation pour l'exemple)
                // Dans une version complète, il faudrait parser les fractions comme "7 1/8" correctement
                giron_mm = parseFloat(giron) * 25.4;
                hauteur_mm = parseFloat(hauteurContremarche) * 25.4;
                largeur_mm = parseFloat(largeurEscalier) * 25.4;
                hauteurlibre_mm = parseFloat(hauteurLibre) * 25.4;
            } else {
                giron_mm = parseFloat(giron);
                hauteur_mm = parseFloat(hauteurContremarche);
                largeur_mm = parseFloat(largeurEscalier);
                hauteurlibre_mm = parseFloat(hauteurLibre);
            }
            
            // Vérifier la conformité
            var gironConforme = giron_mm >= minGiron && giron_mm <= maxGiron;
            var hauteurConforme = hauteur_mm >= minHauteur && hauteur_mm <= maxHauteur;
            var largeurConforme = largeur_mm >= minLargeur;
            var hauteurLibreConforme = hauteurlibre_mm >= minHauteurLibre;
            
            // Calcul de la formule du pas pour vérifier le confort
            var formulePas = 2 * hauteur_mm + giron_mm;
            var formulePasConforme = formulePas >= 550 && formulePas <= 700; // mm (environ 22-27.5 po)
            
            // Afficher les résultats
            var resultatsDiv = document.getElementById("resultats-verification");
            resultatsDiv.innerHTML = `
                <h3>Résultats de la vérification</h3>
                <p><strong>Giron:</strong> ${gironConforme ? "✓ Conforme" : "✗ Non conforme"} (Min: ${minGiron} mm, Max: ${maxGiron === Infinity ? "Aucune limite" : maxGiron + " mm"})</p>
                <p><strong>Hauteur de contremarche:</strong> ${hauteurConforme ? "✓ Conforme" : "✗ Non conforme"} (Min: ${minHauteur} mm, Max: ${maxHauteur} mm)</p>
                <p><strong>Largeur de l'escalier:</strong> ${largeurConforme ? "✓ Conforme" : "✗ Non conforme"} (Min: ${minLargeur} mm)</p>
                <p><strong>Hauteur libre:</strong> ${hauteurLibreConforme ? "✓ Conforme" : "✗ Non conforme"} (Min: ${minHauteurLibre} mm)</p>
                <p><strong>Formule du pas:</strong> 2 × ${hauteur_mm.toFixed(1)} + ${giron_mm.toFixed(1)} = ${formulePas.toFixed(1)} mm ${formulePasConforme ? "✓ Confortable" : "✗ Moins confortable"}</p>
                <hr>
                <p><strong>Conformité globale:</strong> ${gironConforme && hauteurConforme && largeurConforme && hauteurLibreConforme ? "✓ L'escalier est conforme au Code National du Bâtiment 2015, section 9.8." : "✗ L'escalier n'est pas conforme au Code National du Bâtiment 2015, section 9.8."}</p>
            `;
            resultatsDiv.classList.remove("hidden");
        }
        
        // Initialiser les écouteurs d'événements au chargement
        document.addEventListener("DOMContentLoaded", function() {
            // Vérifier la configuration initiale
            toggleRayonnanteOptions();
            toggleRayonnanteOptionsVerif();
        });
    </script>
</body>
</html>
